# Ralph Progress Log
Started: Event Finder with AI-Powered Plugin Generation
Branch: ralph/event-finder
---

## Codebase Patterns
- Run backend with: `python3 -m uvicorn backend.main:app --reload`
- Run mypy typecheck with: `python3 -m mypy backend/ --ignore-missing-imports`
- FastAPI app uses APIRouter with `/api` prefix for all endpoints
- Run frontend with: `cd frontend && npm run dev`
- Run frontend typecheck with: `cd frontend && npx tsc --noEmit`
- Frontend uses Tailwind CSS v4 via @tailwindcss/vite plugin (import with `@import "tailwindcss"`)
- Frontend proxy configured: `/api` routes to backend at localhost:8000
- Backend requires `backend/__init__.py` for mypy to resolve module paths correctly
- Plugin imports use `from backend.models import Event` (full path from project root)
- Plugin loader: use `reload_plugins()` after adding new plugins to refresh registry
- Plugin registry access: `get_plugin_registry()` returns dict[name, class], `get_plugin_info()` returns API-friendly list
- AI service: use `send_message()` for raw Claude calls, `chat_with_context()` for EventFinder-specific chat

---

## 2026-01-26 - US-001
- Implemented FastAPI backend scaffolding
- Files changed:
  - backend/main.py - FastAPI app with CORS and health endpoint
  - backend/requirements.txt - Dependencies (fastapi, uvicorn, pydantic, anthropic, crawl4ai)
- **Learnings for future iterations:**
  - Use `python3 -m uvicorn` rather than just `uvicorn` if uvicorn is not on PATH
  - FastAPI app is configured with CORS for localhost:5173 (Vite default)
  - Health check at GET /api/health returns {"status": "ok"}
---

## 2026-01-26 - US-002
- Set up React frontend with Vite and TypeScript
- Files changed:
  - frontend/ - New Vite + React + TypeScript project
  - frontend/vite.config.ts - Added Tailwind CSS plugin and proxy to backend
  - frontend/src/index.css - Tailwind CSS import
  - frontend/src/App.tsx - Basic placeholder with Tailwind styling
- **Learnings for future iterations:**
  - Tailwind CSS v4 uses `@import "tailwindcss"` in CSS (no directives like @tailwind base)
  - Use @tailwindcss/vite plugin for Vite integration (not postcss config)
  - Vite proxy config at `server.proxy` maps `/api` to backend localhost:8000
  - TypeScript build command: `tsc -b && vite build` (runs typecheck then build)
---

## 2026-01-26 - US-003
- Defined Event Pydantic model and ScraperPlugin abstract base class
- Files changed:
  - backend/__init__.py - Created to make backend a proper Python package
  - backend/models.py - Event Pydantic model with all required fields
  - backend/plugins/__init__.py - Plugin package init, exports ScraperPlugin
  - backend/plugins/base.py - ScraperPlugin ABC with name, source_url, description attributes, abstract scrape() method, and crawl() helper using AsyncWebCrawler
- **Learnings for future iterations:**
  - Backend needs `__init__.py` for mypy module resolution to work correctly
  - ScraperPlugin subclasses must define name, source_url, description as class attributes
  - crawl() helper returns markdown representation of page from crawl4ai
---

## 2026-01-26 - US-004
- Created Luma scraper plugin implementing ScraperPlugin interface
- Files changed:
  - backend/plugins/luma.py - LumaPlugin class that scrapes events from lu.ma/sf
- **Learnings for future iterations:**
  - ScraperPlugin subclasses use the inherited crawl() method to fetch markdown content
  - Event parsing from markdown requires flexible regex patterns for dates/times/locations
  - Always wrap scrape() in try/except and return empty list on error (log the error)
  - Generate unique event IDs with uuid.uuid4()
  - Luma event links are formatted as [Title](https://lu.ma/...) in markdown output
---

## 2026-01-26 - US-005
- Implemented plugin loader system for dynamic plugin discovery and loading
- Files changed:
  - backend/services/__init__.py - Created services package
  - backend/services/plugin_loader.py - Plugin loader with scan, load, reload, and registry functions
  - backend/main.py - Added /api/plugins endpoint and plugin loading on startup
- **Learnings for future iterations:**
  - Use `importlib.util.spec_from_file_location()` for dynamic module imports
  - Plugin registry is a module-level dict (`_plugin_registry`) for state persistence
  - `get_plugin_info()` returns list of dicts suitable for API responses
  - `reload_plugins()` clears registry and reloads all plugins (useful after plugin generation)
  - Plugins are loaded on app startup via `@app.on_event("startup")` decorator
---

## 2026-01-26 - US-006
- Created Claude AI service for chat and recommendations
- Files changed:
  - backend/services/ai.py - Claude AI service with send_message and chat_with_context functions
- **Learnings for future iterations:**
  - Use `claude-sonnet-4-20250514` model ID for Claude Sonnet
  - Anthropic SDK: `client.messages.create()` returns response with content blocks
  - Handle different error types: AuthenticationError, RateLimitError, APIStatusError, APIError
  - Return user-friendly error messages instead of raising exceptions for recoverable errors
  - ANTHROPIC_API_KEY must be set in environment before using the service
  - MessageDict type alias: `dict[str, str]` with "role" and "content" keys for conversation history
---
